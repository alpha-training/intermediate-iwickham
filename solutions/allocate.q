allocate:{  
    p:floor x1:x*y%sum y;
    p[max t?t:x1-p]+:x-sum floor x1:x*y%sum y;
    p
    }

